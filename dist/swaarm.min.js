window._Swaarm={getQueryParams:function(i){i=i.split("+").join(" ");for(var t,n={},e=/[?&]?([^=]+)=([^&]*)/g;t=e.exec(i);)n[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return n},setCookie:function(i,t,n){var e="";if(n){var r=new Date;r.setTime(r.getTime()+60*n*60*1e3),e="; expires="+r.toUTCString()}document.cookie=i+"="+(t||"")+e+"; path=/"},getCookie:function(i){for(var t=i+"=",n=document.cookie.split(";"),e=0;e<n.length;e++){for(var r=n[e];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null},SWAARM_CLICK_ID_NAME:"swaarm_clkid",DEBUG:!1,log:function(i){this.DEBUG&&console.log("[SWWARM#SDK] "+i)},emitEvent:function(i,t){var n=this.trackingUrl+"postback?click_id="+i;for(var e in null==t&&(t={}),t)Object.prototype.hasOwnProperty.call(t,e)&&null!=t[e]&&(n+="&"+e+"="+t[e]);this.sendRequest(n)},sendRequest:function(i,t,n){this.log("Requesting "+i);var e=new XMLHttpRequest,r=this;e.addEventListener("load",(function(){r.log("Request to "+i+" sent successfully.")})),e.onreadystatechange=function(i){if(4===e.readyState&&200===e.status){var r=e.responseText;!0===n&&(r=JSON.parse(e.responseText)),null!=t&&t(r)}},e.open("GET",i),e.send()},validateInit:function(){if(!this.configured)throw new Error("You need to configure the Swaarm by calling Swaarm.initialize before using it.")},initialize:function(i){if(null==i||!i.startsWith("http"))throw new Error("Invalid tracking url received: "+i);"/"!==i.slice(-1)&&(i+="/"),this.trackingUrl=i,this.configured=!0},enableDebug:function(){this.DEBUG=!0},land:function(){this.validateInit();var i=this.getQueryParams(window.location.search);null!=i.clkid?(this.log("Saving clkid "+i.clkid+"."),window.localStorage.setItem(this.SWAARM_CLICK_ID_NAME,i.clkid),this.setCookie(this.SWAARM_CLICK_ID_NAME,i.clkid,168)):this.log("No clkid found.")},click:function(){this.validateInit();var i=window.location.search;this.sendRequest(this.trackingUrl+"click"+i)},adDetails:function(i,t,n){this.validateInit();var e=window.location.search;null!=i&&null!=t&&(e="offer_id="+i+"&pub_id"+t),this.sendRequest(this.trackingUrl+"ad"+e,n,!0)},replaceMarkedLinks:function(i,t,n){var e=null==i?"a":i,r=this;this.adDetails(null,null,(function(i){var a=i.advertiserTrackingUrl,o=i.clickTrackingUrl+"&no_redirect=true",l=i.impressionTrackingUrl+"&no_redirect=true";null==t?r.sendRequest(l):r.sendRequest(r.trackingUrl+"click?offer_id="+t+"&pub_id="+n+"&no_redirect=true"),document.querySelectorAll(e).forEach((i=>{i.href=a,i.addEventListener("click",(function(){r.sendRequest(o,(function(){document.location.href=a}))}))}))}))},impression:function(){this.validateInit();var i=window.location.search;this.sendRequest(this.trackingUrl+"impression"+i)},getClickId:function(){var i=window.localStorage.getItem(this.SWAARM_CLICK_ID_NAME);return null==i&&(i=this.getCookie(this.SWAARM_CLICK_ID_NAME)),i},attribute:function(){this.event(null)},event:function(i){this.validateInit();var t=this.getClickId();null!=t?this.emitEvent(t,i):this.log("No clickid found. Organic attribution.")}},window.Swaarm={initialize:function(i){window._Swaarm.initialize(i.trackingUrl),i.debug&&window._Swaarm.enableDebug()},replaceMarkedLinks:function(i,t,n){window._Swaarm.replaceMarkedLinks(i,t,n)},land:function(){window._Swaarm.land()},identifier:function(){return window._Swaarm.getClickId()},attribute:function(){window._Swaarm.attribute()},event:function(i,t){t=null==t?{}:t,window._Swaarm.event({event_id:i,sale_amount:t.saleAmount,sale_amount_currency:t.saleAmountCurrency,original_sale_amount:t.originalSaleAmount,original_sale_amount_currency:t.originalSaleAmountCurrency})}};