window._Swaarm={_generateUUID:function(){for(var i={},t=[],n=0;n<256;n++)t[n]=(n<16?"0":"")+n.toString(16);return i.generate=function(){var i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,a=4294967295*Math.random()|0;return t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&e|128]+t[e>>8&255]+"-"+t[e>>16&255]+t[e>>24&255]+t[255&a]+t[a>>8&255]+t[a>>16&255]+t[a>>24&255]},i.generate()},getQueryParams:function(i){i=i.split("+").join(" ");for(var t,n={},e=/[?&]?([^=]+)=([^&]*)/g;t=e.exec(i);)n[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return n},SWAARM_CLICK_ID_NAME:"swaarm_clkid",DEBUG:!1,log:function(i){this.DEBUG&&console.log("[SWWARM#SDK] "+i)},emitEvent:function(i,t){var n=this.trackingUrl+"postback?click_id="+i;for(var e in null==t&&(t={}),t)Object.prototype.hasOwnProperty.call(t,e)&&null!=t[e]&&(n+="&"+e+"="+t[e]);this.sendRequest(n)},sendRequest:function(i,t,n){this.log("Requesting "+i);var e=new XMLHttpRequest,a=this;e.addEventListener("load",(function(){a.log("Request to "+i+" sent successfully.")})),e.onreadystatechange=function(i){if(4===e.readyState&&200===e.status){var a=e.responseText;!0===n&&(a=JSON.parse(e.responseText)),null!=t&&t(a)}},e.open("GET",i),e.send()},validateInit:function(){if(!this.configured)throw new Error("You need to configure the Swaarm by calling Swaarm.initialize before using it.")},initialize:function(i,t){if(null==i||!i.startsWith("http"))throw new Error("Invalid tracking url received: "+i);"/"!==i.slice(-1)&&(i+="/"),this.trackingUrl=i,this.configured=!0,this.webToken=t},enableDebug:function(){this.DEBUG=!0},_collectUtmData:function(){var i=this.getQueryParams(window.location.search),t=[];return i.utm_campaign&&t.push("campaign="+i.utm_campaign),i.utm_adset&&t.push("adset="+i.utm_adset),i.utm_ad&&t.push("ad="+i.utm_ad),i.utm_source&&t.push("site="+i.utm_source),i.utm_term&&t.push("term="+i.utm_term),i.swcid&&t.push("campaign_id="+i.swcid),i.swasid&&t.push("adset_id="+i.swasid),i.swaid&&t.push("ad_id="+i.swasid),i.swc&&t.push("campaign_id="+i.swc),i.swas&&t.push("adset_id="+i.swas),i.swa&&t.push("ad_id="+i.swa),i.gclid&&t.push("pub_click_id="+i.gclid),i.fbclid&&t.push("pub_click_id="+i.fbclid),i.ttclid&&t.push("pub_click_id="+i.ttclid),t.join("&")},_landOrganic:function(){var i=this.trackingUrl+"click?no_redirect=true&web_token="+this.webToken+"&"+this._collectUtmData();this.log("Organic user.");var t=this;this.sendRequest(i,(function(i){t._saveClickId(i.id)}),!0)},_saveClickId:function(i){this.log("Saving clkid "+i+"."),window.localStorage.setItem(this.SWAARM_CLICK_ID_NAME,i)},land:function(){this.validateInit();var i=this.getQueryParams(window.location.search);if(null==i.clkid)return this.log("No clkid found."),void this._landOrganic();this._saveClickId(i.clkid)},click:function(i,t){this.validateInit(),this._baseClickImpression("click",i,t)},impression:function(i,t){this.validateInit(),this._baseClickImpression("impression",i,t)},_baseClickImpression:function(i,t,n){this.validateInit();var e=this.getQueryParams(window.location.search);for(var a in t)e[a]=t[a];var r=[];for(var s in e)r.push(s+"="+e[s]);var o=r.join("&");this.sendRequest(this.trackingUrl+i+o,n,!1)},adDetails:function(i,t,n){this.validateInit();var e=window.location.search;null!=i&&null!=t&&(e="offer_id="+i+"&pub_id"+t),this.sendRequest(this.trackingUrl+"ad"+e,n,!0)},replaceMarkedLinks:function(i,t,n){var e=null==i?"a":i,a=this;this.adDetails(null,null,(function(i){var r=i.advertiserTrackingUrl,s=i.clickTrackingUrl+"&no_redirect=true",o=i.impressionTrackingUrl+"&no_redirect=true";null==t?a.sendRequest(o):a.sendRequest(a.trackingUrl+"click?offer_id="+t+"&pub_id="+n+"&no_redirect=true"),document.querySelectorAll(e).forEach((i=>{i.href=r,i.addEventListener("click",(function(){a.sendRequest(s,(function(){document.location.href=r}))}))}))}))},getClickId:function(){return window.localStorage.getItem(this.SWAARM_CLICK_ID_NAME)},_getUserId:function(){return window.localStorage.getItem(this.SWAARM_CLICK_ID_NAME)},attribute:function(){this.event(null)},event:function(i){this.validateInit();var t=this.getClickId();null!=t?this.emitEvent(t,i):this.log("No clickid found. Organic attribution.")}},window.Swaarm={initialize:function(i){window._Swaarm.initialize(i.trackingUrl,i.webToken),i.debug&&window._Swaarm.enableDebug()},replaceMarkedLinks:function(i,t,n){window._Swaarm.replaceMarkedLinks(i,t,n)},land:function(){window._Swaarm.land()},click:function(i,t){window._Swaarm.click(i,t)},impression:function(i,t){window._Swaarm.click(i,t)},identifier:function(){return window._Swaarm._getUserId()},attribute:function(){window._Swaarm.attribute()},event:function(i,t){t=null==t?{}:t,window._Swaarm.event({event_id:i,sale_amount:t.saleAmount,sale_amount_currency:t.saleAmountCurrency,original_sale_amount:t.originalSaleAmount,original_sale_amount_currency:t.originalSaleAmountCurrency})},open:function(){this.event("__open")}};