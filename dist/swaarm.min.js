window._Swaarm={getQueryParams:function(i){i=i.split("+").join(" ");for(var n,t={},e=/[?&]?([^=]+)=([^&]*)/g;n=e.exec(i);)t[decodeURIComponent(n[1])]=decodeURIComponent(n[2]);return t},setCookie:function(i,n,t){var e="";if(t){var r=new Date;r.setTime(r.getTime()+60*t*60*1e3),e="; expires="+r.toUTCString()}document.cookie=i+"="+(n||"")+e+"; path=/"},getCookie:function(i){for(var n=i+"=",t=document.cookie.split(";"),e=0;e<t.length;e++){for(var r=t[e];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(n))return r.substring(n.length,r.length)}return null},SWAARM_CLICK_ID_NAME:"swaarm_clkid",DEBUG:!1,log:function(i){this.DEBUG&&console.log("[SWWARM#SDK] "+i)},emitEvent:function(i,n){var t=this.trackingUrl+"postback?click_id="+i;for(var e in null==n&&(n={}),n)Object.prototype.hasOwnProperty.call(n,e)&&null!=n[e]&&(t+="&"+e+"="+n[e]);this.sendRequest(t)},sendRequest:function(i,n,t){this.log("Requesting "+i);var e=new XMLHttpRequest,r=this;e.addEventListener("load",(function(){r.log("Request to "+i+" sent successfully.")})),e.onreadystatechange=function(i){if(4===e.readyState&&200===e.status){var r=e.responseText;!0===t&&(r=JSON.parse(e.responseText)),null!=n&&n(r)}},e.open("GET",i),e.send()},validateInit:function(){if(!this.configured)throw new Error("You need to configure the Swaarm by calling Swaarm.initialize before using it.")},initialize:function(i){if(null==i||!i.startsWith("http"))throw new Error("Invalid tracking url received: "+i);"/"!==i.slice(-1)&&(i+="/"),this.trackingUrl=i,this.configured=!0},enableDebug:function(){this.DEBUG=!0},land:function(){this.validateInit();var i=this.getQueryParams(window.location.search);null!=i.clkid?(this.log("Saving clkid "+i.clkid+"."),window.localStorage.setItem(this.SWAARM_CLICK_ID_NAME,i.clkid),this.setCookie(this.SWAARM_CLICK_ID_NAME,i.clkid,168)):this.log("No clkid found.")},click:function(i,n){this.validateInit(),this._baseClickImpression("click",i,n)},impression:function(i,n){this.validateInit(),this._baseClickImpression("impression",i,n)},_baseClickImpression:function(i,n,t){this.validateInit();var e=this.getQueryParams(window.location.search);for(var r in n)e[r]=n[r];var a=[];for(var o in e)a.push(o+"="+e[o]);var l=a.join("&");this.sendRequest(this.trackingUrl+i+l,t,!1)},adDetails:function(i,n,t){this.validateInit();var e=window.location.search;null!=i&&null!=n&&(e="offer_id="+i+"&pub_id"+n),this.sendRequest(this.trackingUrl+"ad"+e,t,!0)},replaceMarkedLinks:function(i,n,t){var e=null==i?"a":i,r=this;this.adDetails(null,null,(function(i){var a=i.advertiserTrackingUrl,o=i.clickTrackingUrl+"&no_redirect=true",l=i.impressionTrackingUrl+"&no_redirect=true";null==n?r.sendRequest(l):r.sendRequest(r.trackingUrl+"click?offer_id="+n+"&pub_id="+t+"&no_redirect=true"),document.querySelectorAll(e).forEach((i=>{i.href=a,i.addEventListener("click",(function(){r.sendRequest(o,(function(){document.location.href=a}))}))}))}))},getClickId:function(){var i=window.localStorage.getItem(this.SWAARM_CLICK_ID_NAME);return null==i&&(i=this.getCookie(this.SWAARM_CLICK_ID_NAME)),i},attribute:function(){this.event(null)},event:function(i){this.validateInit();var n=this.getClickId();null!=n?this.emitEvent(n,i):this.log("No clickid found. Organic attribution.")}},window.Swaarm={initialize:function(i){window._Swaarm.initialize(i.trackingUrl),i.debug&&window._Swaarm.enableDebug()},replaceMarkedLinks:function(i,n,t){window._Swaarm.replaceMarkedLinks(i,n,t)},land:function(){window._Swaarm.land()},click:function(i,n){window._Swaarm.click(i,n)},impression:function(i,n){window._Swaarm.click(i,n)},identifier:function(){return window._Swaarm.getClickId()},attribute:function(){window._Swaarm.attribute()},event:function(i,n){n=null==n?{}:n,window._Swaarm.event({event_id:i,sale_amount:n.saleAmount,sale_amount_currency:n.saleAmountCurrency,original_sale_amount:n.originalSaleAmount,original_sale_amount_currency:n.originalSaleAmountCurrency})}};